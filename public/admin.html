<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>⚙️ Admin - Crepería O&amp;E</title>
  <link rel="stylesheet" href="/css/global.css"/>
  <link rel="stylesheet" href="/css/admin.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>

</head>
<body>
  <!-- Header -->
  <div id="header-placeholder" aria-hidden="true"></div>

  <main class="account-shell">
    <div class="account-title">MI CUENTA</div>

    <div class="dashboard">
      <!-- =================== Sidebar =================== -->
      <aside class="side" aria-label="Menú de administración">
        <div class="side-title">Panel</div>
        <nav class="menu" id="admin-menu">
          <div class="menu-group">Mi Cuenta</div>
          <a href="#perfil" class="active"><i class="fas fa-user-gear"></i> Mis Datos</a>
          <a href="#pedidos"><i class="fas fa-receipt"></i> Historial de Pedidos</a>
          <a href="#config"><i class="fas fa-sliders"></i> Configuración</a>

          <!-- Secciones de administración -->
          <div class="admin-actions-section">
            <div class="menu-group admin-actions-legend">Acciones de administrador</div>
            <a href="dashboard.html" class="admin-only"><i class="fas fa-chart-line"></i> Dashboard</a>
            <a href="#productos" class="admin-only"><i class="fas fa-utensils"></i> Productos</a>
            <a href="#usuarios" class="admin-only"><i class="fas fa-users"></i> Usuarios</a>
            <a href="#costos" class="admin-only"><i class="fas fa-calculator"></i> Costos estimados</a>
          </div>

          <small class="muted" style="margin:1rem 1rem 0;">ACCIONES RÁPIDAS</small>
          <a href="#" id="btn-logout"><i class="fas fa-right-from-bracket"></i> Cerrar sesión</a>
        </nav>
      </aside>

      <!-- =================== Panel principal =================== -->
      <section class="panel">
        <h2 id="panel-title" class="section-title"><i class="fas fa-user-gear"></i> Mi perfil</h2>
        <div class="divider"></div>

        <div id="panel-content">
          <!-- ========== VISTA PERFIL ========== -->
          <div id="view-perfil" class="card">
            <div class="grid-2">
              <div>
                <div class="row"><label class="muted">Nombre</label><div id="perfil-nombre-view"></div></div>
                <div class="row"><label class="muted">Teléfono</label><div id="perfil-telefono-view"></div></div>
                <div class="row"><label class="muted">Dirección</label><div id="perfil-direccion-view"></div></div>
              </div>
              <div>
                <div class="row"><label class="muted">Correo</label><div id="perfil-email-view"></div></div>
                <div class="row"><label class="muted">Rol</label><div id="perfil-rol-view"></div></div>
              </div>
            </div>
            <div class="actions">
              <button class="btn-soft" id="btn-perfil-editar"><i class="fas fa-pen-to-square"></i> Modificar</button>
            </div>
          </div>

          <!-- Formulario edición perfil (oculto) -->
          <form id="form-perfil" class="card" style="display:none;">
            <div class="grid-2">
              <div>
                <div class="row"><label>Nombre</label><input class="input" id="perfil-nombre" required/></div>
                <div class="row"><label>Teléfono</label><input class="input" id="perfil-telefono"/></div>
                <div class="row"><label>Dirección</label><textarea class="input" id="perfil-direccion" rows="3"></textarea></div>
              </div>
              <div>
                <div class="row"><label>Correo</label><input class="input" id="perfil-email" type="email" required/></div>
                <div class="row"><label>Rol</label><input class="input readonly" readonly/></div>
              </div>
            </div>
            <div class="actions">
              <button type="button" class="btn-soft" style="background:#e5e7eb;color:#111;" id="perfil-cancelar">Cancelar</button>
              <button type="submit" class="btn-soft"><i class="fas fa-floppy-disk"></i> Guardar</button>
            </div>
          </form>

          <!-- ========== VISTA USUARIOS ========== -->
          <div id="view-usuarios" class="card-table admin-only" style="display:none;">
            <div class="actions">
              <button class="btn-soft" id="btn-add-user"><i class="fas fa-user-plus"></i> Agregar usuario</button>
            </div>
            <table class="table">
              <thead><tr><th>ID</th><th>Nombre</th><th>Email</th><th>Teléfono</th><th>Rol</th><th></th></tr></thead>
              <tbody id="tbl-usuarios-body">
              </tbody>
            </table>
          </div>

          <!-- ========== VISTA PRODUCTOS ========== -->
          <div id="view-productos" class="card-table admin-only" style="display:none;">
            <div class="actions">
              <button class="btn-soft" id="btn-add-product"><i class="fas fa-cookie"></i> Agregar producto</button>
            </div>
            <table class="table">
              <thead><tr><th>ID</th><th>Nombre</th><th>Precio</th><th>Stock</th><th>Activo</th><th></th></tr></thead>
              <tbody id="tbl-productos-body">
              </tbody>
            </table>
          </div>

          <!-- ========== VISTA COSTOS ESTIMADOS ========== -->
          <div id="view-costos" class="card admin-only" style="display:none;">
            <div class="card-title"><i class="fas fa-calculator"></i> Valoración de costos estimados</div>
            <p class="card-helper">Ingresa los costos estimados por crepa, los consumos del mes y la información de producción para obtener automáticamente la valorización de la producción terminada, en proceso y vendida.</p>

            <div class="costs-layout">
              <form id="costos-form" class="costs-inputs" novalidate>
                <section class="cost-card">
                  <h3><i class="fas fa-scale-balanced"></i> Costos estimados por crepa</h3>
                  <div class="field-group">
                    <div class="field">
                      <label for="cost-unit-mp">Materia prima por crepa</label>
                      <input id="cost-unit-mp" class="input" type="number" min="0" step="0.01" placeholder="Q0.00" required>
                    </div>
                    <div class="field">
                      <label for="cost-unit-mo">Mano de obra por crepa</label>
                      <input id="cost-unit-mo" class="input" type="number" min="0" step="0.01" placeholder="Q0.00" required>
                    </div>
                    <div class="field">
                      <label for="cost-unit-gf">Gastos de fabricación por crepa</label>
                      <input id="cost-unit-gf" class="input" type="number" min="0" step="0.01" placeholder="Q0.00" required>
                    </div>
                  </div>
                </section>

                <section class="cost-card">
                  <h3><i class="fas fa-sack-dollar"></i> Consumos del mes</h3>
                  <div class="field-group">
                    <div class="field">
                      <label for="cost-month-mp">Materia prima consumida</label>
                      <input id="cost-month-mp" class="input" type="number" min="0" step="0.01" placeholder="Q0.00">
                    </div>
                    <div class="field">
                      <label for="cost-month-mo">Mano de obra pagada</label>
                      <input id="cost-month-mo" class="input" type="number" min="0" step="0.01" placeholder="Q0.00">
                    </div>
                    <div class="field">
                      <label for="cost-month-gf">Gastos de fabricación</label>
                      <input id="cost-month-gf" class="input" type="number" min="0" step="0.01" placeholder="Q0.00">
                    </div>
                  </div>
                </section>

                <section class="cost-card">
                  <h3><i class="fas fa-industry"></i> Producción y ventas</h3>
                  <div class="field-group">
                    <div class="field">
                      <label for="cost-production-started">Producción comenzada (unidades)</label>
                      <input id="cost-production-started" class="input" type="number" min="0" step="0.01" placeholder="0">
                    </div>
                    <div class="field">
                      <label for="cost-production-finished">Producción terminada (unidades)</label>
                      <input id="cost-production-finished" class="input" type="number" min="0" step="0.01" placeholder="0">
                    </div>
                    <div class="field">
                      <label for="cost-sales">Ventas (unidades)</label>
                      <input id="cost-sales" class="input" type="number" min="0" step="0.01" placeholder="0">
                    </div>
                    <div class="field">
                      <label for="cost-month-name">Mes del reporte</label>
                      <input id="cost-month-name" class="input" type="text" placeholder="Agosto">
                    </div>
                  </div>
                  <div class="cost-form-actions">
                    <button type="reset" class="btn-light"><i class="fas fa-eraser"></i> Limpiar datos</button>
                  </div>
                </section>
              </form>

              <div class="costs-results">
                <div class="cost-warning" id="cost-warning" role="alert" aria-live="polite" style="display:none;">
                  <i class="fas fa-triangle-exclamation"></i>
                  La producción terminada no puede ser mayor que la producción comenzada. Se usará la diferencia máxima posible para calcular la producción en proceso.
                </div>

                <div class="cost-stats">
                  <div class="cost-stat">
                    <span class="cost-stat-label">Producción comenzada</span>
                    <span class="cost-stat-value" id="cost-summary-started">0 crepas</span>
                  </div>
                  <div class="cost-stat">
                    <span class="cost-stat-label">Producción terminada</span>
                    <span class="cost-stat-value" id="cost-summary-finished">0 crepas</span>
                  </div>
                  <div class="cost-stat">
                    <span class="cost-stat-label">Producción en proceso</span>
                    <span class="cost-stat-value" id="cost-summary-process">0 crepas</span>
                  </div>
                  <div class="cost-stat">
                    <span class="cost-stat-label">Ventas</span>
                    <span class="cost-stat-value" id="cost-summary-sales">0 crepas</span>
                  </div>
                </div>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-clipboard-list"></i> Consumos del mes</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr><th>Elementos</th><th>Costo del mes</th></tr>
                    </thead>
                    <tbody id="cost-summary-body"></tbody>
                    <tfoot>
                      <tr><td>Total</td><td id="cost-summary-total">Q 0.00</td></tr>
                    </tfoot>
                  </table>
                </section>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-check-circle"></i> Valorización de producción terminada</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr><th>Elementos</th><th>Unidades</th><th>Costo unitario</th><th>Costo total</th></tr>
                    </thead>
                    <tbody id="cost-finished-body"></tbody>
                    <tfoot>
                      <tr><td colspan="3">Total producción terminada</td><td id="cost-finished-total">Q 0.00</td></tr>
                    </tfoot>
                  </table>
                </section>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-spinner"></i> Valorización de producción en proceso</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr><th>Elementos</th><th>Unidades</th><th>Costo unitario</th><th>Costo total</th></tr>
                    </thead>
                    <tbody id="cost-process-body"></tbody>
                    <tfoot>
                      <tr><td colspan="3">Total producción en proceso</td><td id="cost-process-total">Q 0.00</td></tr>
                    </tfoot>
                  </table>
                </section>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-store"></i> Valorización de producción vendida</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr><th>Elementos</th><th>Unidades</th><th>Costo unitario</th><th>Costo total</th></tr>
                    </thead>
                    <tbody id="cost-sales-body"></tbody>
                    <tfoot>
                      <tr><td colspan="3">Total producción vendida</td><td id="cost-sales-total">Q 0.00</td></tr>
                    </tfoot>
                  </table>
                </section>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-arrow-trend-down"></i> Variaciones de los elementos del costo</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr><th>Elementos</th><th>Costo estimado</th><th>Costo real</th><th>Variación</th><th>Tipo de variación</th></tr>
                    </thead>
                    <tbody id="cost-variance-body"></tbody>
                    <tfoot>
                      <tr>
                        <td>Total</td>
                        <td id="cost-variance-total-estimated">Q 0.00</td>
                        <td id="cost-variance-total-real">Q 0.00</td>
                        <td id="cost-variance-total-diff">Q 0.00</td>
                        <td id="cost-variance-total-type"><span class="status pending">Sin variación</span></td>
                      </tr>
                    </tfoot>
                  </table>
                </section>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-divide"></i> Coeficientes rectificadores por elemento del costo</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr><th>Elementos</th><th>Variación</th><th>Costo estimado</th><th>Coeficiente</th><th>Tipo de variación</th></tr>
                    </thead>
                    <tbody id="cost-coefficient-body"></tbody>
                  </table>
                </section>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-arrows-rotate"></i> Rectificación del costo unitario estimado</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr>
                        <th>Elementos</th>
                        <th>Costo estimado unitario</th>
                        <th>Coeficiente rectificador</th>
                        <th>Cifra de corrección</th>
                        <th>Costo unitario corregido</th>
                      </tr>
                    </thead>
                    <tbody id="cost-rectification-body"></tbody>
                  </table>
                </section>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-boxes"></i> Ajuste del costo de existencia de la producción terminada</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr>
                        <th>Elementos</th>
                        <th>Unidades</th>
                        <th>Costo unitario estimado</th>
                        <th>Costo estimado total</th>
                        <th>Costo unitario corregido</th>
                        <th>Costo total corregido</th>
                        <th>Cifra de ajuste</th>
                      </tr>
                    </thead>
                    <tbody id="cost-adjust-finished-body"></tbody>
                    <tfoot>
                      <tr>
                        <td colspan="3">Total</td>
                        <td id="cost-adjust-finished-estimated-total">Q 0.00</td>
                        <td>—</td>
                        <td id="cost-adjust-finished-corrected-total">Q 0.00</td>
                        <td id="cost-adjust-finished-adjustment-total">Q 0.00</td>
                      </tr>
                    </tfoot>
                  </table>
                </section>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-gears"></i> Ajuste del costo de la producción en proceso</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr>
                        <th>Elementos</th>
                        <th>Unidades</th>
                        <th>Costo unitario estimado</th>
                        <th>Costo estimado total</th>
                        <th>Costo unitario corregido</th>
                        <th>Costo total corregido</th>
                        <th>Cifra de ajuste</th>
                      </tr>
                    </thead>
                    <tbody id="cost-adjust-process-body"></tbody>
                    <tfoot>
                      <tr>
                        <td colspan="3">Total</td>
                        <td id="cost-adjust-process-estimated-total">Q 0.00</td>
                        <td>—</td>
                        <td id="cost-adjust-process-corrected-total">Q 0.00</td>
                        <td id="cost-adjust-process-adjustment-total">Q 0.00</td>
                      </tr>
                    </tfoot>
                  </table>
                </section>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-store-alt"></i> Ajuste del costo de la producción vendida</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr>
                        <th>Elementos</th>
                        <th>Unidades</th>
                        <th>Costo unitario estimado</th>
                        <th>Costo estimado total</th>
                        <th>Costo unitario corregido</th>
                        <th>Costo total corregido</th>
                        <th>Cifra de ajuste</th>
                      </tr>
                    </thead>
                    <tbody id="cost-adjust-sales-body"></tbody>
                    <tfoot>
                      <tr>
                        <td colspan="3">Total</td>
                        <td id="cost-adjust-sales-estimated-total">Q 0.00</td>
                        <td>—</td>
                        <td id="cost-adjust-sales-corrected-total">Q 0.00</td>
                        <td id="cost-adjust-sales-adjustment-total">Q 0.00</td>
                      </tr>
                    </tfoot>
                  </table>
                </section>

                <section class="cost-result">
                  <header>
                    <h3><i class="fas fa-clipboard-check"></i> Resumen de ajustes al costo</h3>
                    <p class="cost-result-month" data-month-label>MES EN CURSO</p>
                  </header>
                  <table class="table cost-table">
                    <thead>
                      <tr>
                        <th>Concepto</th>
                        <th>Materia prima</th>
                        <th>Mano de obra</th>
                        <th>Gastos de fabricación</th>
                        <th>Total</th>
                      </tr>
                    </thead>
                    <tbody id="cost-adjust-summary-body"></tbody>
                    <tfoot>
                      <tr id="cost-adjust-summary-total-row">
                        <td>Total</td>
                        <td>Q 0.00</td>
                        <td>Q 0.00</td>
                        <td>Q 0.00</td>
                        <td>Q 0.00</td>
                      </tr>
                    </tfoot>
                  </table>
                </section>
              </div>
            </div>
          </div>

          <!-- ========== VISTA PEDIDOS ========== -->
          <div id="view-pedidos" class="card-table" style="display:none;">
            <table class="table">
              <thead><tr><th>#</th><th>Fecha</th><th>Total</th><th>Estado</th><th></th></tr></thead>
              <tbody id="tbl-pedidos-body">
              </tbody>
            </table>
          </div>

          <!-- ========== VISTA CONFIGURACIÓN ========== -->
          <div id="view-config" class="card" style="display:none;">
            <div class="row">
              <label>Tema</label>
              <button class="btn-soft" id="btn-toggle-theme"><i class="fas fa-moon"></i> Tema oscuro</button>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Footer -->
  <div id="footer-placeholder" aria-hidden="true"></div>

  <!-- Scripts base -->
  <script src="/js/global.js"></script>
  <script src="/js/admin.js"></script>
  <script src="/js/cart.js"></script>
</body>
</html>
